<!doctype html><html lang="pl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pozycja+Kamera+NFC</title>
<style>
body{font-family:sans-serif;}
video{width:100%;max-width:400px;background:#000;border:2px solid #333;border-radius:8px;margin:10px 0;}
pre{background:#eee;padding:10px;border-radius:6px;white-space:pre-line;}
button{margin:5px;padding:10px;}
</style>
</head><body>

<pre id="pos">...</pre>
<video id="cam" autoplay playsinline></video>
<button id="v">Wibracja</button>
<button id="n">NFC</button>

<script>
const pos=document.getElementById("pos"),cam=document.getElementById("cam");
let la,lo,a,h,b,g,nf;

function show(){
pos.textContent=
(la?`Lat:${la}\nLon:${lo}\nDokł:${Math.round(a)}m\n`:"")+
(h!=null?`Kier:${Math.round(h)}°\n`:"")+
(b!=null?`β:${Math.round(b)}°\n`:"")+
(g!=null?`γ:${Math.round(g)}°\n`:"")+
(nf?`NFC:${nf}`:"");
}

navigator.geolocation?.watchPosition(p=>{
la=p.coords.latitude.toFixed(6);
lo=p.coords.longitude.toFixed(6);
a=p.coords.accuracy;show();
});

window.addEventListener("deviceorientation",e=>{
if(e.alpha!=null)h=360-e.alpha;
if(e.beta!=null)b=e.beta;
if(e.gamma!=null)g=e.gamma;
show();
});

navigator.mediaDevices?.getUserMedia({video:{facingMode:"user"}})
.then(s=>cam.srcObject=s);

v.onclick=()=>navigator.vibrate?.(200);

n.onclick=async()=>{
if(!("NDEFReader"in window))return;
let r=new NDEFReader();
await r.scan();
r.onreading=e=>{
for(const rec of e.message.records){
if(rec.recordType==="text"){
nf=new TextDecoder(rec.encoding).decode(rec.data);
} }
show();
};
};
</script>
</body></html>
