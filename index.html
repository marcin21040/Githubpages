<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Moja pozycja + kierunek</title>
</head>
<body>
  <pre id="pos">Pobieranie danych...</pre>

  <script>
    const el = document.getElementById('pos');
    let lat, lon, acc, heading, beta, gamma;

    function pokaz() {
      el.textContent =
        (lat ? `Lat: ${lat}\nLon: ${lon}\nDokładność: ${Math.round(acc)} m\n` : '') +
        (heading != null ? `Kierunek (alpha): ${Math.round(heading)}°\n` : '') +
        (beta != null ? `Kąt (beta): ${Math.round(beta)}°\n` : '') +
        (gamma != null ? `Kąt (gamma): ${Math.round(gamma)}°\n` : '');
    }

    if ("geolocation" in navigator) {
      navigator.geolocation.watchPosition(
        pos => {
          lat = pos.coords.latitude.toFixed(6);
          lon = pos.coords.longitude.toFixed(6);
          acc = pos.coords.accuracy;
          pokaz();
        },
        err => el.textContent = "Błąd: " + err.message,
        { enableHighAccuracy: true }
      );
    } else {
      el.textContent = "Brak wsparcia geolokalizacji.";
    }

    if ("DeviceOrientationEvent" in window) {
      window.addEventListener("deviceorientation", e => {
        if (e.alpha != null) {
          heading = 360 - e.alpha;  // Kierunek
        }
        if (e.beta != null) {
          beta = e.beta;  // Kąt nachylenia w pionie
        }
        if (e.gamma != null) {
          gamma = e.gamma;  // Kąt nachylenia w poziomie
        }
        pokaz();
      });
    } else {
      el.textContent += "\nBrak wsparcia orientacji.";
    }
  </script>
</body>
</html>
